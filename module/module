{"cells":[{"cell_type":"code","execution_count":59,"metadata":{"id":"n_hbH7tm9Nu6","executionInfo":{"status":"ok","timestamp":1763700718164,"user_tz":-330,"elapsed":16,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["# #%pip install python-dotenv\n","# # !pip install -q langchain langchain-openai langchain-experimental pandas\n","\n","# from dotenv import load_dotenv,find_dotenv\n","# import os\n","# load_dotenv(find_dotenv())\n","\n","# import pandas as pd\n","# from langchain_openai import ChatOpenAI\n","# from langchain_experimental.agents import create_pandas_dataframe_agent\n","# from google.colab import files\n","\n","# import json"]},{"cell_type":"code","execution_count":60,"metadata":{"id":"-edl6UqRKi0L","executionInfo":{"status":"ok","timestamp":1763700718185,"user_tz":-330,"elapsed":2,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["# curl -fsSL https://ollama.com/install.sh | sh\n","# ollama serve\n","# ollama pull llama3"]},{"cell_type":"code","execution_count":61,"metadata":{"id":"cnY1OrxO-2jJ","executionInfo":{"status":"ok","timestamp":1763700718226,"user_tz":-330,"elapsed":21,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["# # Install dependencies\n","# # !pip install -q langchain langchain-openai pandas\n","\n","# import os\n","# import json\n","# import pandas as pd\n","# from pandas import json_normalize\n","# from langchain_openai import ChatOpenAI\n","# from langchain_experimental.agents import create_pandas_dataframe_agent\n","# from google.colab import files\n","\n","# # 1️⃣ Upload JSON file\n","# # uploaded = files.upload()\n","# # file_name = list(uploaded.keys())[0]\n","\n","# # 2️⃣ Load JSON data\n","# with open(\"canada.json\", \"r\") as f:\n","#     data = json.load(f)\n","\n","# # If JSON is nested\n","# df = json_normalize(data)\n","\n","# # 3️⃣ Set API key securely\n","# os.environ[\"OPENAI_API_KEY\"] = \"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\"\n","\n","# # 4️⃣ Create Chat Model\n","# chat = ChatOpenAI(\n","#     model=\"gpt-4o\",\n","#     temperature=0.0\n","# )\n","\n","# # 5️⃣ Create Pandas Agent\n","# agent = create_pandas_dataframe_agent(\n","#     chat,\n","#     df,\n","#     verbose=True,\n","#     allow_dangerous_code=True\n","# )\n","\n","# # 6️⃣ Example Query\n","# response = agent.run(\"Give me first 5 rows data\")\n","# print(response)\n"]},{"cell_type":"code","execution_count":62,"metadata":{"id":"BkJA1sXdHsyI","executionInfo":{"status":"ok","timestamp":1763700718265,"user_tz":-330,"elapsed":19,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["# !pip install pymongo\n","# !pip install mysql-connector"]},{"cell_type":"code","execution_count":63,"metadata":{"id":"wTd7Zwq3IVMC","executionInfo":{"status":"ok","timestamp":1763700718290,"user_tz":-330,"elapsed":22,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["# from pymongo import MongoClient\n","\n","# client=MongoClient(\"mongodb+srv://kunalshelke121200:kunalkunal@kunal.9r5eh.mongodb.net/?retryWrites=true&w=majority&appName=kunal\")\n","\n","# db=client.get_database(\"dataset\")\n","# records=db.columns\n","# db=client.test\n","# records.insert_one({\"_id\":0, \"rollno\":3,\"name\":\"anil\"})\n","\n"]},{"cell_type":"code","execution_count":64,"metadata":{"id":"ISZ1mTb5T391","executionInfo":{"status":"ok","timestamp":1763700718419,"user_tz":-330,"elapsed":107,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["# import mysql.connector\n","# mydb=mysql.connector.connect(\n","#     host=\"localhost\",\n","#     user=\"root\",\n","#     password=\"@#19CADBURY43\"\n","# )\n","# mycursor=mydb.cursor()\n","# mycursor.execute(\"show databases\")"]},{"cell_type":"code","execution_count":65,"metadata":{"id":"vJ5lmAobxeKG","executionInfo":{"status":"ok","timestamp":1763700718428,"user_tz":-330,"elapsed":4,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["character_columns=['name', 'department', 'departments', 'team', 'teams', 'product', 'products',\n"," 'region', 'regions', 'subject', 'subjects', 'class', 'school', 'schools',\n"," 'assignment', 'assignments', 'age group', 'age groups', 'disease', 'diseases',\n"," 'hospital', 'hospitals', 'city', 'cities', 'campaign', 'campaigns',\n"," 'platform', 'platforms', 'segment', 'segments', 'ad type', 'ad types',\n"," 'device', 'devices', 'app version', 'app versions', 'feature', 'features',\n"," 'day', 'days', 'error type', 'error types', 'country', 'countries', 'state', 'states',\n"," 'zone', 'zones', 'income bracket', 'income brackets', 'gender', 'genders',\n"," 'warehouse', 'warehouses', 'category', 'categories', 'supplier', 'suppliers',\n"," 'delivery route', 'delivery routes', 'shipment date', 'shipment dates',\n"," 'storage section', 'storage sections', 'developer', 'developers',\n"," 'module', 'modules', 'sprint', 'sprints', 'bug type', 'bug types',\n"," 'task', 'tasks', 'product type', 'product types', 'payment method',\n"," 'payment methods', 'customer', 'coupon', 'coupon codes', 'store branch',\n"," 'store branches', 'content type', 'content types', 'influencer',\n"," 'influencers', 'hashtag', 'hashtags', 'posting time', 'posting times',\n"," 'audience segment', 'audience segments', 'district', 'districts',\n"," 'scheme', 'schemes', 'utility', 'utility types', 'complaint type',\n"," 'complaint types', 'license category', 'license categories',\n"," 'player', 'players', 'match', 'matches', 'event', 'events',\n"," 'training', 'exercise', 'exercises', 'sleep day', 'meal', 'meals',\n"," 'expense category', 'expense categories', 'mood', 'book', 'books',\n"," 'course', 'courses', 'topic', 'topics', 'quiz', 'attempt', 'instructor',\n"," 'instructors', 'skill', 'skills', 'learning mode', 'learning modes',\n"," 'entry', 'entries', 'journal', 'peer', 'certificate', 'certificates']\n"]},{"cell_type":"code","execution_count":66,"metadata":{"id":"RiAGEGJnyTug","executionInfo":{"status":"ok","timestamp":1763700718464,"user_tz":-330,"elapsed":33,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["time_columns=['date', 'dates', 'time', 'times', 'timestamp', 'timestamps', 'datetime', 'datetimes','month', 'months',\n","              'week', 'weeks', 'day', 'days',\n"," 'quarter', 'quarters', 'year', 'years', 'time slot', 'time slots',\n"," 'date', 'dates', 'season', 'seasons', 'hour', 'hours',\n"," 'posting time', 'posting times', 'training day', 'sleep day',\n"," 'shipment date', 'shipment dates','qtr']"]},{"cell_type":"code","execution_count":67,"metadata":{"id":"IybPX-9JU6Td","executionInfo":{"status":"ok","timestamp":1763700718540,"user_tz":-330,"elapsed":73,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["location_terms = {\n","    \"country\": [\n","        \"country\", \"nation\", \"country_name\", \"nationality\", \"sovereign_state\",\n","        \"land\", \"homeland\", \"country_code\", \"iso_country\", \"nation_name\",\n","        \"odname\", \"dev\", \"world\", \"continent\", \"subcontinent\", \"subregion\",\n","        \"member_state\", \"member_country\", \"state_party\"\n","    ],\n","    \"city\": [\n","        \"city\", \"town\", \"municipality\", \"metro\", \"metropolis\", \"urban_area\",\n","        \"city_name\", \"township\", \"borough\", \"capital\", \"village\", \"urban\",\n","        \"metro_area\", \"conurbation\", \"settlement\", \"locality_name\"\n","    ],\n","    \"state\": [\n","        \"state\", \"province\", \"region\", \"territory\", \"governorate\", \"prefecture\",\n","        \"division\", \"county\", \"oblast\", \"subdivision\", \"federal_state\", \"administrative_area\",\n","        \"state_name\", \"province_name\", \"region_name\", \"territory_name\", \"governorate_name\",\n","        \"prefecture_name\", \"division_name\", \"county_name\", \"oblast_name\",\n","        \"state_code\", \"province_code\", \"region_code\", \"territory_code\", \"governorate_code\",\n","        \"prefecture_code\", \"division_code\", \"county_code\", \"oblast_code\",\n","        \"state_id\", \"province_id\", \"region_id\", \"territory_id\", \"governorate_id\",\n","        \"prefecture_id\", \"division_id\", \"county_id\", \"oblast_id\",\n","        \"state_abbr\", \"province_abbr\", \"region_abbr\", \"territory_abbr\", \"governorate_abbr\",\n","        \"prefecture_abbr\", \"division_abbr\", \"county_abbr\", \"oblast_abbr\",\n","        \"state_iso\", \"province_iso\", \"region_iso\", \"territory_iso\", \"governorate_iso\",\n","        \"prefecture_iso\", \"division_iso\", \"county_iso\", \"oblast_iso\",\n","        \"reg\", \"reg_name\", \"reg_code\", \"reg_abbr\", \"reg_iso\", \"regname\",\n","        \"statehood\", \"admin_region\", \"admin_division\", \"state_entity\"\n","    ],\n","    \"area\": [\n","        \"area\", \"district\", \"locality\", \"zone\", \"subzone\", \"sector\",\n","        \"ward\", \"neighborhood\", \"region_area\", \"block\", \"circle\", \"areaname\",\n","        \"subdistrict\", \"tehsil\", \"taluka\", \"parish\", \"commune\", \"borough_area\"\n","    ],\n","    \"postal\": [\n","        \"postal\",\"postalcode\", \"postal_code\", \"zipcode\", \"zip\", \"pin\", \"pincode\",\n","        \"post_code\", \"mail_code\", \"zip_code\", \"postal_number\", \"postcode\",\n","        \"delivery_code\", \"sorting_code\"\n","    ],\n","    \"address\": [\n","        \"address\", \"street\", \"street_address\", \"road\", \"lane\", \"avenue\", \"drive\",\n","        \"colony\", \"apartment\", \"flat\", \"building\", \"house_number\", \"location\",\n","        \"residence\", \"unit\", \"plot\", \"lot\", \"address_line\"\n","    ],\n","    \"coordinates\": [\n","        \"latitude\", \"lat\", \"longitude\", \"lon\", \"lng\", \"geo\",\n","        \"geo_location\", \"coordinates\", \"x_coord\", \"y_coord\", \"geocode\",\n","        \"latlon\", \"longlat\", \"gps\", \"spatial\", \"geom\"\n","    ]\n","}\n"]},{"cell_type":"code","execution_count":68,"metadata":{"id":"U1Z3d9iQyoOy","executionInfo":{"status":"ok","timestamp":1763700718545,"user_tz":-330,"elapsed":2,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["Numerical_columns=['id','sales', 'revenue', 'growth', 'expense', 'expenses', 'count', 'counts',\n"," 'score', 'scores', 'rating', 'ratings', 'completion', 'attendance',\n"," 'population', 'income', 'performance', 'progress', 'conversion',\n"," 'clicks', 'reach', 'usage', 'crashes', 'crash', 'frequency',\n"," 'GDP', 'engagement', 'vaccinations', 'mortality', 'patients',\n"," 'cases', 'admissions', 'footfall', 'impressions', 'views',\n"," 'capacity', 'volume', 'stats', 'mastery', 'attempts',\n"," 'coverage', 'distribution', 'amount', 'percent', 'percentage',\n"," 'rate', 'rates', 'spent', 'spend', 'return', 'budget', 'budgets',\n"," 'redemption', 'allocation', 'satisfaction', 'like', 'likes',\n"," 'share', 'shares', 'followers', 'follower', 'reach', 'ROI',\n"," 'usage', 'value', 'values', 'lead', 'leads', 'crashes',\n"," 'api calls', 'downloads', 'temperature', 'transactions',\n"," 'visits', 'visitors', 'literacy', 'energy', 'traffic',\n"," 'restock', 'delivery', 'orders', 'stock', 'quantity',\n"," 'damage', 'line', 'code', 'bugs', 'fixed', 'commits',\n"," 'test coverage', 'placed', 'purchases', 'calories',\n"," 'calorie', 'burned', 'speed', 'ranking', 'point', 'points',\n"," 'goals', 'score', 'completed', 'attempts', 'correct',\n"," 'answer', 'difficulty', 'duration', 'productivity',\n"," 'usage', 'conversion', 'engagement', 'impressions','avg','average']\n"]},{"cell_type":"code","execution_count":69,"metadata":{"id":"tLqga8W8cyQH","executionInfo":{"status":"ok","timestamp":1763700718548,"user_tz":-330,"elapsed":1,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["Contact = [\"phone\",\"phone_number\",\"mobile\",\"mobile_number\",\"contact\",\"contact_number\",\n","           \"telephone\",\"telephone_number\",\"cell\",\"cell_number\",\"phone_no\",\"mobile_no\",\n","           \"contact_no\",\"tel_no\",\"primary_phone\",\"secondary_phone\",\"work_phone\",\"home_phone\",\n","           \"office_phone\",\"personal_phone\",\"emergency_contact_number\"]\n"]},{"cell_type":"code","execution_count":70,"metadata":{"id":"puhZMBATReGd","executionInfo":{"status":"ok","timestamp":1763700718551,"user_tz":-330,"elapsed":1,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["import pandas as pd\n","import re\n","from os import replace"]},{"cell_type":"code","execution_count":71,"metadata":{"id":"qRvNGasXuGy9","executionInfo":{"status":"ok","timestamp":1763700719698,"user_tz":-330,"elapsed":1146,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["df=pd.read_csv('superstore_sales.csv',encoding='latin1')\n","# df=pd.read_excel(\"Tableau Joins File.xlsx\")\n","# df=pd.read_json(\"try.json\")"]},{"cell_type":"code","execution_count":72,"metadata":{"id":"5s8Bl7NNKVvi","executionInfo":{"status":"ok","timestamp":1763700719706,"user_tz":-330,"elapsed":6,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["total_column_count=0\n","total_row_count=0\n","column_name=[]\n","null_columns=[]\n","droped_column=[]\n","numerical_columns=[]\n","phone_number_column=[]\n","alpha_columns=[]\n","date_columns=[]\n","location_columns=[]\n","country=[]\n","city=[]\n","state=[]\n","postal_code=[]\n","area=[]\n","address=[]\n","coordinates=[]"]},{"cell_type":"code","execution_count":73,"metadata":{"id":"-Vho2IUYf0jJ","executionInfo":{"status":"ok","timestamp":1763700719740,"user_tz":-330,"elapsed":16,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["df.columns = df.columns.str.strip().str.replace(r'\\s+', '_', regex=True).str.lower()"]},{"cell_type":"code","execution_count":74,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"rYj4Nh1HnZ1E","executionInfo":{"status":"ok","timestamp":1763700719752,"user_tz":-330,"elapsed":9,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}},"outputId":"fb3dd7c5-f859-4dc1-c43e-8e68b72906f0"},"outputs":[{"output_type":"stream","name":"stdout","text":["21\n"]}],"source":["total_column_count=len(df.columns)\n","print(total_column_count)"]},{"cell_type":"code","execution_count":75,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"51evaqDkn3gE","executionInfo":{"status":"ok","timestamp":1763700719779,"user_tz":-330,"elapsed":27,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}},"outputId":"d9fa7245-4fa3-4e83-cc8b-cf22d5c15c95"},"outputs":[{"output_type":"stream","name":"stdout","text":["51290\n"]}],"source":["total_row_count=len(df)\n","print(total_row_count)"]},{"cell_type":"code","execution_count":76,"metadata":{"id":"DHIYPAZ2xUBV","executionInfo":{"status":"ok","timestamp":1763700719911,"user_tz":-330,"elapsed":131,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["df.drop_duplicates(inplace=True)"]},{"cell_type":"code","execution_count":77,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"QV0Umd2cxZ0p","executionInfo":{"status":"ok","timestamp":1763700719939,"user_tz":-330,"elapsed":25,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}},"outputId":"c7eb2b66-11cc-4160-aa37-17ad3029093c"},"outputs":[{"output_type":"stream","name":"stdout","text":["21\n"]}],"source":["total_column_count=len(df.columns)\n","print(total_column_count)"]},{"cell_type":"code","execution_count":78,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Kl2iZ6UZxj8l","executionInfo":{"status":"ok","timestamp":1763700720080,"user_tz":-330,"elapsed":138,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}},"outputId":"758da873-0f4d-41c3-8100-759543fb5e9b"},"outputs":[{"output_type":"stream","name":"stdout","text":["51290\n"]}],"source":["total_row_count=len(df)\n","print(total_row_count)"]},{"cell_type":"code","execution_count":79,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"fp6IoDEjn_7g","executionInfo":{"status":"ok","timestamp":1763700720090,"user_tz":-330,"elapsed":9,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}},"outputId":"16f585ff-21c1-433f-c4c6-39c2a5d85f7a"},"outputs":[{"output_type":"stream","name":"stdout","text":["Index(['order_id', 'order_date', 'ship_date', 'ship_mode', 'customer_name',\n","       'segment', 'state', 'country', 'market', 'region', 'product_id',\n","       'category', 'sub_category', 'product_name', 'sales', 'quantity',\n","       'discount', 'profit', 'shipping_cost', 'order_priority', 'year'],\n","      dtype='object')\n"]}],"source":["column_name=df.columns\n","print(column_name)"]},{"cell_type":"code","execution_count":80,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"0NKmmZhLoH8i","executionInfo":{"status":"ok","timestamp":1763700720137,"user_tz":-330,"elapsed":46,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}},"outputId":"05eeab50-5939-4de8-b656-e195de0cd682"},"outputs":[{"output_type":"stream","name":"stdout","text":["[]\n"]}],"source":["null_columns=df.columns[df.isnull().any()].tolist()\n","print(null_columns)"]},{"cell_type":"code","execution_count":81,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"cvZxO7jKslbT","executionInfo":{"status":"ok","timestamp":1763700720200,"user_tz":-330,"elapsed":77,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}},"outputId":"6402c5bb-92d2-4bd2-ebc6-015118a19099"},"outputs":[{"output_type":"stream","name":"stdout","text":["[]\n"]}],"source":["droped_column=[]\n","for i in null_columns:\n","  if (df[i].count()<= (len(df)//3)):\n","    droped_column.append(i)\n","    df.drop(columns=[i],inplace=True)\n","print(droped_column)"]},{"cell_type":"code","execution_count":82,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"dN5QhkAAznis","executionInfo":{"status":"ok","timestamp":1763700720239,"user_tz":-330,"elapsed":39,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}},"outputId":"6a2208ed-fd35-47c7-9521-b455f2bfaf01"},"outputs":[{"output_type":"stream","name":"stdout","text":["[]\n"]}],"source":["null_columns=df.columns[df.isnull().any()].tolist()\n","print(null_columns)"]},{"cell_type":"code","execution_count":83,"metadata":{"collapsed":true,"id":"Z5uW13ZqDeJ3","executionInfo":{"status":"ok","timestamp":1763700720243,"user_tz":-330,"elapsed":2,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["# for i in df.columns:\n","#   print(df[i].describe(),\"\\n\")"]},{"cell_type":"code","execution_count":84,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_C1hKI5-cH2H","executionInfo":{"status":"ok","timestamp":1763700720272,"user_tz":-330,"elapsed":28,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}},"outputId":"5da97f5a-2e68-490d-9c8d-fb9f2a355a31"},"outputs":[{"output_type":"stream","name":"stdout","text":["['quantity', 'discount', 'profit', 'shipping_cost', 'year']\n"]}],"source":["numerical_columns=df.select_dtypes(include=\"number\").columns.tolist()\n","print(numerical_columns)"]},{"cell_type":"code","execution_count":85,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"W4cc6p7jdd9C","executionInfo":{"status":"ok","timestamp":1763700720286,"user_tz":-330,"elapsed":11,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}},"outputId":"0021e54b-ec0a-4814-ad78-376dee2cca16"},"outputs":[{"output_type":"stream","name":"stdout","text":["['order_id', 'order_date', 'ship_date', 'ship_mode', 'customer_name', 'segment', 'state', 'country', 'market', 'region', 'product_id', 'category', 'sub_category', 'product_name', 'sales', 'order_priority']\n"]}],"source":["alpha_columns=df.select_dtypes(include=['object','string']).columns.tolist()\n","print(alpha_columns)"]},{"cell_type":"code","execution_count":86,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"mok28tRooFVX","executionInfo":{"status":"ok","timestamp":1763700720331,"user_tz":-330,"elapsed":44,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}},"outputId":"0ae7297f-eede-4fc4-ab50-96c511f70e92"},"outputs":[{"output_type":"stream","name":"stdout","text":["[]\n"]}],"source":["date_columns=df.select_dtypes(include=['datetime']).columns.tolist()\n","print(date_columns)"]},{"cell_type":"code","execution_count":87,"metadata":{"id":"4XVB_KKZoTko","executionInfo":{"status":"ok","timestamp":1763700720384,"user_tz":-330,"elapsed":50,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["#check date in numerical\n","\n","from os import replace\n","for check_date in numerical_columns:\n","  check=check_date.translate(str.maketrans(\"_-/\",\"   \")).split()\n","  for i in check[:]:\n","    for j in time_columns:\n","      if i==j:\n","        if check_date not in date_columns:\n","          date_columns.append(check_date)\n","        if check_date not in time_columns:\n","          time_columns.append(check_date)\n","          break\n","        else:\n","          break\n","for r in date_columns:\n","  if r in numerical_columns:\n","    numerical_columns.remove(r)"]},{"cell_type":"code","execution_count":88,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"sCC7qDe-FFG7","executionInfo":{"status":"ok","timestamp":1763700720409,"user_tz":-330,"elapsed":7,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}},"outputId":"840790eb-4b10-4b44-fb98-962952e5c7e5"},"outputs":[{"output_type":"stream","name":"stdout","text":["['order_id', 'order_date', 'ship_date', 'ship_mode', 'customer_name', 'segment', 'state', 'country', 'market', 'region', 'product_id', 'category', 'sub_category', 'product_name', 'sales', 'order_priority']\n","['quantity', 'discount', 'profit', 'shipping_cost']\n","['year']\n","[]\n"]}],"source":["print(alpha_columns)\n","print(numerical_columns)\n","print(date_columns)\n","print(location_columns)"]},{"cell_type":"code","execution_count":89,"metadata":{"collapsed":true,"id":"7Ai9t1ejdg0X","executionInfo":{"status":"ok","timestamp":1763700720448,"user_tz":-330,"elapsed":20,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["#check aplha column to dataset\n","\n","for j in alpha_columns:\n","  for i in character_columns:\n","    if j==i:\n","      flag=0\n","      break\n","    flag=1\n","  if flag==1:\n","    character_columns.append(j)"]},{"cell_type":"code","execution_count":90,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"rpvQCIv7FEYz","executionInfo":{"status":"ok","timestamp":1763700720461,"user_tz":-330,"elapsed":11,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}},"outputId":"9b316567-56e7-41ac-895a-ca02c3e25b9c"},"outputs":[{"output_type":"stream","name":"stdout","text":["['order_id', 'order_date', 'ship_date', 'ship_mode', 'customer_name', 'segment', 'state', 'country', 'market', 'region', 'product_id', 'category', 'sub_category', 'product_name', 'sales', 'order_priority']\n","['quantity', 'discount', 'profit', 'shipping_cost']\n","['year']\n","[]\n"]}],"source":["print(alpha_columns)\n","print(numerical_columns)\n","print(date_columns)\n","print(location_columns)"]},{"cell_type":"code","execution_count":91,"metadata":{"id":"w-tw2uTUS0qu","executionInfo":{"status":"ok","timestamp":1763700720464,"user_tz":-330,"elapsed":2,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["#check date column from dataset\n","\n","for i in alpha_columns:\n","  for j in time_columns:\n","    if i==j:\n","      if i not in date_columns:\n","        date_columns.append(i)\n","      break\n","for r in date_columns:\n","  if r in alpha_columns:\n","    alpha_columns.remove(r)"]},{"cell_type":"code","execution_count":92,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"dcblNrHLFDny","executionInfo":{"status":"ok","timestamp":1763700720473,"user_tz":-330,"elapsed":7,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}},"outputId":"2c71ec67-2c31-4485-eff3-1032af01aec9"},"outputs":[{"output_type":"stream","name":"stdout","text":["['order_id', 'order_date', 'ship_date', 'ship_mode', 'customer_name', 'segment', 'state', 'country', 'market', 'region', 'product_id', 'category', 'sub_category', 'product_name', 'sales', 'order_priority']\n","['quantity', 'discount', 'profit', 'shipping_cost']\n","['year']\n","[]\n"]}],"source":["print(alpha_columns)\n","print(numerical_columns)\n","print(date_columns)\n","print(location_columns)"]},{"cell_type":"code","execution_count":93,"metadata":{"id":"OmLAvCfLT_Wk","executionInfo":{"status":"ok","timestamp":1763700720477,"user_tz":-330,"elapsed":2,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["#check numerical column from dataset\n","\n","for i in alpha_columns:\n","  for j in Numerical_columns:\n","    if i==j:\n","      if i not in numerical_columns:\n","        numerical_columns.append(i)\n","      break\n","for r in numerical_columns:\n","  if r in alpha_columns:\n","    alpha_columns.remove(r)"]},{"cell_type":"code","execution_count":94,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"OF9QqaZ5FCwk","executionInfo":{"status":"ok","timestamp":1763700720507,"user_tz":-330,"elapsed":28,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}},"outputId":"e3ead0d2-05d3-4b41-d4df-5cff3ffec4db"},"outputs":[{"output_type":"stream","name":"stdout","text":["['order_id', 'order_date', 'ship_date', 'ship_mode', 'customer_name', 'segment', 'state', 'country', 'market', 'region', 'product_id', 'category', 'sub_category', 'product_name', 'order_priority']\n","['quantity', 'discount', 'profit', 'shipping_cost', 'sales']\n","['year']\n","[]\n"]}],"source":["print(alpha_columns)\n","print(numerical_columns)\n","print(date_columns)\n","print(location_columns)"]},{"cell_type":"code","execution_count":95,"metadata":{"id":"-8VS5FJ-o2lp","executionInfo":{"status":"ok","timestamp":1763700720510,"user_tz":-330,"elapsed":1,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["#numerical detector___________check later\n","\n","for i in alpha_columns:\n","    for j in Numerical_columns:\n","        pattern = (\n","            r'(^' + re.escape(j) + r'$|' +\n","            r'^' + re.escape(j) + r'([_\\-\\s]|$)|' +\n","            r'([_\\-\\s]|^)' + re.escape(j) + r'$|' +\n","            r'.*'+re.escape(j)+r'.*'\n","            r')'\n","        )\n","        if re.search(pattern, i, re.IGNORECASE):\n","            if i not in numerical_columns:\n","              v=df.loc[0,i]\n","              val=\"1234567890%.$-*+\"\n","              nflag=0\n","              for fst in v:\n","                if fst in val:\n","                  nflag=nflag+1\n","              if nflag==(len(v)):\n","                df[i]=(df[i]\n","                  .astype(str)\n","                  .str.replace(r\"[,_\\-%\\$\\*]\", \"\", regex=True)\n","                  .str.strip()\n","                  )\n","                df[i]=pd.to_numeric(df[i],errors=\"coerce\")\n","                numerical_columns.append(i)\n","              break\n","\n","for r in numerical_columns:\n","    if r in alpha_columns:\n","        alpha_columns.remove(r)\n"]},{"cell_type":"code","execution_count":96,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"S1hQJigbFB0z","executionInfo":{"status":"ok","timestamp":1763700720520,"user_tz":-330,"elapsed":8,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}},"outputId":"9169cd0e-0437-48ae-ed10-d481be4f0576"},"outputs":[{"output_type":"stream","name":"stdout","text":["['order_id', 'order_date', 'ship_date', 'ship_mode', 'customer_name', 'segment', 'state', 'country', 'market', 'region', 'product_id', 'category', 'sub_category', 'product_name', 'order_priority']\n","['quantity', 'discount', 'profit', 'shipping_cost', 'sales']\n","['year']\n","[]\n"]}],"source":["print(alpha_columns)\n","print(numerical_columns)\n","print(date_columns)\n","print(location_columns)"]},{"cell_type":"code","execution_count":97,"metadata":{"id":"nYFAz6SrskGV","executionInfo":{"status":"ok","timestamp":1763700720524,"user_tz":-330,"elapsed":1,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["#date time detector\n","\n","import re\n","\n","for i in alpha_columns:\n","    for j in time_columns:\n","        pattern = (\n","            r'(^' + re.escape(j) + r'$|' +\n","            r'^' + re.escape(j) + r'([_\\-\\s]|$)|' +\n","            r'([_\\-\\s]|^)' + re.escape(j) + r'$|' +\n","            r'.*' + re.escape(j) + r'.*'\n","            r')'\n","        )\n","        if re.search(pattern, i, re.IGNORECASE):\n","            if i not in date_columns:\n","                date_columns.append(i)\n","            break\n","\n","for r in date_columns:\n","  df[r] = pd.to_datetime(df[r], errors=\"coerce\")\n","  if r in alpha_columns:\n","      alpha_columns.remove(r)\n"]},{"cell_type":"code","execution_count":98,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"PDtyo3uyFA1b","executionInfo":{"status":"ok","timestamp":1763700720556,"user_tz":-330,"elapsed":30,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}},"outputId":"e2a54305-2889-4899-cb7d-b68fbb782e99"},"outputs":[{"output_type":"stream","name":"stdout","text":["['order_id', 'ship_mode', 'customer_name', 'segment', 'state', 'country', 'market', 'region', 'product_id', 'category', 'sub_category', 'product_name', 'order_priority']\n","['quantity', 'discount', 'profit', 'shipping_cost', 'sales']\n","['year', 'order_date', 'ship_date']\n","[]\n"]}],"source":["print(alpha_columns)\n","print(numerical_columns)\n","print(date_columns)\n","print(location_columns)"]},{"cell_type":"code","execution_count":99,"metadata":{"id":"ChCVWe_pZTVc","executionInfo":{"status":"ok","timestamp":1763700720574,"user_tz":-330,"elapsed":16,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["#Location detector\n","\n","for i in location_terms:\n","  for j in range(len(location_terms[i])):\n","    for k in alpha_columns:\n","      if k==location_terms[i][j]:\n","        if k not in location_columns:\n","          location_columns.append(k)\n","          if i==\"country\":\n","            country.append(k)\n","          elif i==\"city\":\n","            city.append(k)\n","          elif i==\"state\":\n","            state.append(k)\n","          elif i==\"area\":\n","            area.append(k)\n","          elif i==\"postal\":\n","            postal_code.append(k)\n","          elif i==\"address\":\n","            address.append(k)\n","          elif i==\"coordinates\":\n","            coordinates.append(k)\n","    for n in numerical_columns:\n","      if n==location_terms[i][j]:\n","        if n not in location_columns:\n","          location_columns.append(n)\n","          if i==\"postal\":\n","            postal_code.append(n)\n","for r in location_columns:\n","  if r in alpha_columns:\n","    alpha_columns.remove(r)\n","for rn in location_columns:\n","  if rn in numerical_columns:\n","    numerical_columns.remove(rn)\n"]},{"cell_type":"code","execution_count":100,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ooNY-VakE_bK","executionInfo":{"status":"ok","timestamp":1763700720583,"user_tz":-330,"elapsed":11,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}},"outputId":"1e655412-212d-4268-c1f2-d4d22acde9d8"},"outputs":[{"output_type":"stream","name":"stdout","text":["['order_id', 'ship_mode', 'customer_name', 'segment', 'market', 'product_id', 'category', 'sub_category', 'product_name', 'order_priority']\n","['quantity', 'discount', 'profit', 'shipping_cost', 'sales']\n","['year', 'order_date', 'ship_date']\n","['country', 'state', 'region']\n"]}],"source":["print(alpha_columns)\n","print(numerical_columns)\n","print(date_columns)\n","print(location_columns)"]},{"cell_type":"code","execution_count":101,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_jpxLyQ3cKfW","executionInfo":{"status":"ok","timestamp":1763700720833,"user_tz":-330,"elapsed":222,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}},"outputId":"076ccdc1-f8ab-46b8-cb32-ebc94d6fffbb"},"outputs":[{"output_type":"stream","name":"stdout","text":["['order_id', 'ship_mode', 'customer_name', 'segment', 'market', 'product_id', 'category', 'sub_category', 'product_name', 'order_priority']\n","['quantity', 'discount', 'profit', 'shipping_cost', 'sales']\n","['year', 'order_date', 'ship_date']\n","['country', 'state', 'region']\n"]}],"source":["#non alphabetical pushed to numerical\n","\n","for i in alpha_columns:\n","  flag=0\n","  add=0\n","  sub=0\n","  nct=0\n","  fstvl=0\n","  lstvl=0\n","  special=0\n","  value=df.loc[0,i]\n","  val=\"1234567890\"\n","  alpha = \"abcdefghijklmnopqrstuvwxyz\"\n","  Alpha = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n","  if (len(value)==1) and ((value in alpha) or (value in Alpha)):\n","    continue\n","\n","    if isinstance(value, str):\n","      val=\"1234567890\"\n","      vald=\"1234567890.\"\n","      value=value.replace(\",\",\"\").strip()\n","      for tr in range(len(value)):\n","        if (value[tr] not in val) and (value[tr]==value[0]):\n","          fstvl=1\n","        elif (value[tr] not in val) and (value[tr]==value[-1]):\n","          lstvl=1\n","        elif (value[tr] in val):\n","          flag=flag+1\n","        elif (value[tr]==\".\"):\n","          flag=flag+1\n","          special=special+1\n","    if (fstvl==1) and ((len(value)-1)==flag):\n","      for cv in range(len(df[i])):\n","        val_str = str(df.loc[cv, i])\n","        for see in val_str:\n","          if (sub==0) and (see==\"-\"):\n","            sub=1\n","          elif see not in vald:\n","            val_str = val_str.replace(see, \"\")\n","        df.loc[cv, i] = val_str\n","      df[i]=(df[i]\n","            .astype(str)\n","            .str.replace(\",\",\"\",regex=False)\n","            .str.strip()\n","            )\n","      df[i]=pd.to_numeric(df[i],errors=\"coerce\")\n","      numerical_columns.append(i)\n","    elif (lstvl==1) and ((len(value)-1)==flag):\n","      for cv in range(len(df[i])):\n","        val_str = str(df.loc[cv, i])\n","        for see in val_str:\n","          if (sub==0) and (see==\"-\"):\n","            sub=1\n","          elif see not in vald:\n","            val_str = val_str.replace(see, \"\")\n","        df.loc[cv, i] = val_str\n","      df[i]=(df[i]\n","            .astype(str)\n","            .str.replace(\",\",\"\",regex=False)\n","            .str.strip()\n","            )\n","      df[i]=pd.to_numeric(df[i],errors=\"coerce\")\n","      numerical_columns.append(i)\n","    elif (special==1) and ((len(value))==flag):\n","      for cv in range(len(df[i])):\n","        val_str = str(df.loc[cv, i])\n","        for see in val_str:\n","          if (sub==0) and (see==\"-\"):\n","            sub=1\n","          elif see not in vald:\n","            val_str = val_str.replace(see, \"\")\n","        df.loc[cv, i] = val_str\n","      df[i]=(df[i]\n","            .astype(str)\n","            .str.replace(\",\",\"\",regex=False)\n","            .str.strip()\n","            )\n","      df[i]=pd.to_numeric(df[i],errors=\"coerce\")\n","      numerical_columns.append(i)\n","    elif (special==0) and ((len(value))==flag) and (lstvl==0) and (fstvl==0):\n","      for cv in range(len(df[i])):\n","        val_str = str(df.loc[cv, i])\n","        for see in val_str:\n","          if (sub==0) and (see==\"-\"):\n","            sub=1\n","          elif see not in vald:\n","            val_str = val_str.replace(see, \"\")\n","        df.loc[cv, i] = val_str\n","      df[i]=(df[i]\n","            .astype(str)\n","            .str.replace(\",\",\"\",regex=False)\n","            .str.strip()\n","            )\n","      df[i]=pd.to_numeric(df[i],errors=\"coerce\")\n","      numerical_columns.append(i)\n","  else:\n","    if (isinstance(value,str)):\n","      for cv in value:\n","        if cv in val:\n","          nct=nct+1\n","      if len(value)==nct:\n","        df[i]=(df[i]\n","            .astype(str)\n","            .str.replace(r\"[,_\\-%\\$\\*]\", \"\", regex=True)\n","            .str.strip()\n","            )\n","        df[i]=pd.to_numeric(df[i],errors=\"coerce\")\n","        dt=df[i].dtype\n","        print(dt)\n","        numerical_columns.append(i)\n","\n","for r in numerical_columns:\n","  if r in alpha_columns:\n","    alpha_columns.remove(r)\n","\n","print(alpha_columns)\n","print(numerical_columns)\n","print(date_columns)\n","print(location_columns)"]},{"cell_type":"code","execution_count":102,"metadata":{"id":"L635K18PYyYR","executionInfo":{"status":"ok","timestamp":1763700791469,"user_tz":-330,"elapsed":70632,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["#non numerical pushed to alphabetical\n","\n","for i in numerical_columns:\n","  flag=0\n","  add=0\n","  sub=0\n","  value = df.loc[0, i]\n","  if isinstance(value, str):\n","    val=\"1234567890\"\n","    vald=\"1234567890.\"\n","    alpha=\"abcdefghijklmnopqrstuvwxyz\"\n","    Alpha=\"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n","    value=value.replace(\",\",\"\").strip()\n","    for tr in range(1,len(value)):\n","      if (isinstance(value[0],str) and (value[tr] in val) ) or ((value[0] in val) and (value[tr] in val)) or ((value[tr-1] in val) and (isinstance(value[-1],str))):\n","        flag=1\n","      elif (value[tr] == \".\"):\n","        flag=1\n","      else:\n","        add=add+1\n","  flag=flag+add\n","  if (flag==1) and (((value[0] not in alpha) and (value[0] not in Alpha)) and ((value[-1] not in alpha) and (value[-1] not in Alpha))):\n","    for cv in range(len(df[i])):\n","      val_str = str(df.loc[cv, i])\n","      for see in val_str:\n","        if (sub==0) and (see==\"-\"):\n","          sub=1\n","        elif (see not in vald):\n","          val_str = val_str.replace(see, \"\")\n","      df.loc[cv, i] = val_str\n","    df[i] = (\n","    df[i]\n","    .astype(str)\n","    .str.replace(\",\", \"\", regex=False)\n","    .str.strip())\n","    df[i] = pd.to_numeric(df[i], errors=\"coerce\")\n","  elif (flag>1) or ((flag==1) and (((value[0] in alpha) or (value[0] in Alpha)) or ((value[-1] in alpha) or (value[-1] in Alpha)))):\n","    alpha_columns.append(i)\n","for r in alpha_columns:\n","  if r in numerical_columns:\n","    numerical_columns.remove(r)"]},{"cell_type":"code","execution_count":103,"metadata":{"id":"nOvJ_WP8cDZc","executionInfo":{"status":"ok","timestamp":1763700791740,"user_tz":-330,"elapsed":253,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["for i in numerical_columns:\n","  if i in Contact:\n","    phone_number_column.append(i)\n","    numerical_columns.remove(i)\n"]},{"cell_type":"code","execution_count":104,"metadata":{"id":"Qt_PhwwyGTxT","executionInfo":{"status":"ok","timestamp":1763700791741,"user_tz":-330,"elapsed":236,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["for r in alpha_columns:\n","  if r in numerical_columns:\n","    alpha_columns.remove(r)\n","  elif r in date_columns:\n","    alpha_columns.remove(r)\n","  elif r in location_columns:\n","    alpha_columns.remove(r)"]},{"cell_type":"code","source":["if len(numerical_columns)>0:\n","  for i in numerical_columns:\n","    df[i]=df[i].fillna(0)"],"metadata":{"id":"Ssv_UT4q_43u","executionInfo":{"status":"ok","timestamp":1763700791742,"user_tz":-330,"elapsed":234,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"execution_count":105,"outputs":[]},{"cell_type":"code","execution_count":106,"metadata":{"id":"Jh6hwCUZ6kRv","executionInfo":{"status":"ok","timestamp":1763700791743,"user_tz":-330,"elapsed":24,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"9b3ea882-ed34-4716-db48-c118f3dee0ec"},"outputs":[{"output_type":"stream","name":"stdout","text":["['order_id', 'ship_mode', 'customer_name', 'segment', 'market', 'product_id', 'category', 'sub_category', 'product_name', 'order_priority']\n","['quantity', 'discount', 'profit', 'shipping_cost', 'sales']\n","['year', 'order_date', 'ship_date']\n","['country', 'state', 'region']\n"]}],"source":["print(alpha_columns)\n","print(numerical_columns)\n","print(date_columns)\n","print(location_columns)"]},{"cell_type":"code","execution_count":107,"metadata":{"id":"KvX7kdDlEgKj","executionInfo":{"status":"ok","timestamp":1763700791744,"user_tz":-330,"elapsed":8,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"outputs":[],"source":["# print(len(column_name))\n","# for i in column_name:\n","#    print(i,df[i].dtype)\n","# df.head()\n","# df.tail()"]},{"cell_type":"code","source":["for i in alpha_columns:\n","  df[i]=df[i].str.strip()\n","  df[i]=df[i].str.title()\n","for i in numerical_columns:\n","  df[i]=df[i].fillna(0)"],"metadata":{"id":"LdqX0DBSSet6","executionInfo":{"status":"ok","timestamp":1763700791937,"user_tz":-330,"elapsed":191,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"execution_count":108,"outputs":[]},{"cell_type":"code","source":["# for i in alpha_columns:\n","#   collection={}\n","#   word=df[i].unique()\n","#   count=len(word)\n","#   value=df[i].value_counts()\n","#   print(value)"],"metadata":{"collapsed":true,"id":"60x_NeLVTu7D","executionInfo":{"status":"ok","timestamp":1763700791942,"user_tz":-330,"elapsed":2,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}}},"execution_count":109,"outputs":[]},{"cell_type":"code","source":["df.head()"],"metadata":{"id":"U2hVzwjbm8qs","colab":{"base_uri":"https://localhost:8080/","height":394},"executionInfo":{"status":"ok","timestamp":1763701253249,"user_tz":-330,"elapsed":228,"user":{"displayName":"Kunal Shelke","userId":"04964741532346678157"}},"outputId":"306fae8f-d5f9-418f-ec32-2b8ad51c3253"},"execution_count":114,"outputs":[{"output_type":"execute_result","data":{"text/plain":["          order_id order_date  ship_date       ship_mode    customer_name  \\\n","0     Ag-2011-2040 2011-01-01 2011-06-01  Standard Class  Toby Braunhardt   \n","1    In-2011-47883 2011-01-01 2011-08-01  Standard Class      Joseph Holt   \n","2     Hu-2011-1220 2011-01-01 2011-05-01    Second Class    Annie Thurman   \n","3  It-2011-3647632 2011-01-01 2011-05-01    Second Class     Eugene Moren   \n","4    In-2011-47883 2011-01-01 2011-08-01  Standard Class      Joseph Holt   \n","\n","       segment            state    country  market   region  ...  \\\n","0     Consumer      Constantine    Algeria  Africa   Africa  ...   \n","1     Consumer  New South Wales  Australia    Apac  Oceania  ...   \n","2     Consumer         Budapest    Hungary    Emea     EMEA  ...   \n","3  Home Office        Stockholm     Sweden      Eu    North  ...   \n","4     Consumer  New South Wales  Australia    Apac  Oceania  ...   \n","\n","          category sub_category                 product_name sales  quantity  \\\n","0  Office Supplies      Storage          Tenex Lockers, Blue   408         2   \n","1  Office Supplies     Supplies     Acme Trimmer, High Speed   120         3   \n","2  Office Supplies      Storage      Tenex Box, Single Width    66         4   \n","3  Office Supplies        Paper  Enermax Note Cards, Premium    45         3   \n","4        Furniture  Furnishings   Eldon Light Bulb, Duo Pack   114         5   \n","\n","   discount   profit  shipping_cost  order_priority  \\\n","0       0.0  106.140          35.46          Medium   \n","1       0.1   36.036           9.72          Medium   \n","2       0.0   29.640           8.17            High   \n","3       0.5  -26.055           4.82            High   \n","4       0.1   37.770           4.70          Medium   \n","\n","                           year  \n","0 1970-01-01 00:00:00.000002011  \n","1 1970-01-01 00:00:00.000002011  \n","2 1970-01-01 00:00:00.000002011  \n","3 1970-01-01 00:00:00.000002011  \n","4 1970-01-01 00:00:00.000002011  \n","\n","[5 rows x 21 columns]"],"text/html":["\n","  <div id=\"df-b23407a2-ffd7-4c6e-8fdc-b372a303aee4\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>order_id</th>\n","      <th>order_date</th>\n","      <th>ship_date</th>\n","      <th>ship_mode</th>\n","      <th>customer_name</th>\n","      <th>segment</th>\n","      <th>state</th>\n","      <th>country</th>\n","      <th>market</th>\n","      <th>region</th>\n","      <th>...</th>\n","      <th>category</th>\n","      <th>sub_category</th>\n","      <th>product_name</th>\n","      <th>sales</th>\n","      <th>quantity</th>\n","      <th>discount</th>\n","      <th>profit</th>\n","      <th>shipping_cost</th>\n","      <th>order_priority</th>\n","      <th>year</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Ag-2011-2040</td>\n","      <td>2011-01-01</td>\n","      <td>2011-06-01</td>\n","      <td>Standard Class</td>\n","      <td>Toby Braunhardt</td>\n","      <td>Consumer</td>\n","      <td>Constantine</td>\n","      <td>Algeria</td>\n","      <td>Africa</td>\n","      <td>Africa</td>\n","      <td>...</td>\n","      <td>Office Supplies</td>\n","      <td>Storage</td>\n","      <td>Tenex Lockers, Blue</td>\n","      <td>408</td>\n","      <td>2</td>\n","      <td>0.0</td>\n","      <td>106.140</td>\n","      <td>35.46</td>\n","      <td>Medium</td>\n","      <td>1970-01-01 00:00:00.000002011</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>In-2011-47883</td>\n","      <td>2011-01-01</td>\n","      <td>2011-08-01</td>\n","      <td>Standard Class</td>\n","      <td>Joseph Holt</td>\n","      <td>Consumer</td>\n","      <td>New South Wales</td>\n","      <td>Australia</td>\n","      <td>Apac</td>\n","      <td>Oceania</td>\n","      <td>...</td>\n","      <td>Office Supplies</td>\n","      <td>Supplies</td>\n","      <td>Acme Trimmer, High Speed</td>\n","      <td>120</td>\n","      <td>3</td>\n","      <td>0.1</td>\n","      <td>36.036</td>\n","      <td>9.72</td>\n","      <td>Medium</td>\n","      <td>1970-01-01 00:00:00.000002011</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Hu-2011-1220</td>\n","      <td>2011-01-01</td>\n","      <td>2011-05-01</td>\n","      <td>Second Class</td>\n","      <td>Annie Thurman</td>\n","      <td>Consumer</td>\n","      <td>Budapest</td>\n","      <td>Hungary</td>\n","      <td>Emea</td>\n","      <td>EMEA</td>\n","      <td>...</td>\n","      <td>Office Supplies</td>\n","      <td>Storage</td>\n","      <td>Tenex Box, Single Width</td>\n","      <td>66</td>\n","      <td>4</td>\n","      <td>0.0</td>\n","      <td>29.640</td>\n","      <td>8.17</td>\n","      <td>High</td>\n","      <td>1970-01-01 00:00:00.000002011</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>It-2011-3647632</td>\n","      <td>2011-01-01</td>\n","      <td>2011-05-01</td>\n","      <td>Second Class</td>\n","      <td>Eugene Moren</td>\n","      <td>Home Office</td>\n","      <td>Stockholm</td>\n","      <td>Sweden</td>\n","      <td>Eu</td>\n","      <td>North</td>\n","      <td>...</td>\n","      <td>Office Supplies</td>\n","      <td>Paper</td>\n","      <td>Enermax Note Cards, Premium</td>\n","      <td>45</td>\n","      <td>3</td>\n","      <td>0.5</td>\n","      <td>-26.055</td>\n","      <td>4.82</td>\n","      <td>High</td>\n","      <td>1970-01-01 00:00:00.000002011</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>In-2011-47883</td>\n","      <td>2011-01-01</td>\n","      <td>2011-08-01</td>\n","      <td>Standard Class</td>\n","      <td>Joseph Holt</td>\n","      <td>Consumer</td>\n","      <td>New South Wales</td>\n","      <td>Australia</td>\n","      <td>Apac</td>\n","      <td>Oceania</td>\n","      <td>...</td>\n","      <td>Furniture</td>\n","      <td>Furnishings</td>\n","      <td>Eldon Light Bulb, Duo Pack</td>\n","      <td>114</td>\n","      <td>5</td>\n","      <td>0.1</td>\n","      <td>37.770</td>\n","      <td>4.70</td>\n","      <td>Medium</td>\n","      <td>1970-01-01 00:00:00.000002011</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows × 21 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b23407a2-ffd7-4c6e-8fdc-b372a303aee4')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-b23407a2-ffd7-4c6e-8fdc-b372a303aee4 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-b23407a2-ffd7-4c6e-8fdc-b372a303aee4');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","    <div id=\"df-f7316339-054d-4bce-9a10-681ca38760ad\">\n","      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-f7316339-054d-4bce-9a10-681ca38760ad')\"\n","                title=\"Suggest charts\"\n","                style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","      </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","      <script>\n","        async function quickchart(key) {\n","          const quickchartButtonEl =\n","            document.querySelector('#' + key + ' button');\n","          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","          quickchartButtonEl.classList.add('colab-df-spinner');\n","          try {\n","            const charts = await google.colab.kernel.invokeFunction(\n","                'suggestCharts', [key], {});\n","          } catch (error) {\n","            console.error('Error during call to suggestCharts:', error);\n","          }\n","          quickchartButtonEl.classList.remove('colab-df-spinner');\n","          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","        }\n","        (() => {\n","          let quickchartButtonEl =\n","            document.querySelector('#df-f7316339-054d-4bce-9a10-681ca38760ad button');\n","          quickchartButtonEl.style.display =\n","            google.colab.kernel.accessAllowed ? 'block' : 'none';\n","        })();\n","      </script>\n","    </div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"df"}},"metadata":{},"execution_count":114}]}],"metadata":{"colab":{"provenance":[],"authorship_tag":"ABX9TyOdlXCySwOOqI0QmAZ0vvXN"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}